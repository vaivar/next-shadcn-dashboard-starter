## Copilot Instructions for `next-shadcn-dashboard-starter`

- **Stack & Layout**: Next.js 16 App Router + React 19 + Tailwind v4 + Shadcn UI. Root layout (`src/app/layout.tsx`) wires NextTopLoader, NuqsAdapter, theme classes (`active_theme` cookie), Toaster, and Clerk via `components/layout/providers.tsx`.
- **Auth & Guarding**: Clerk is mandatory for `/dashboard/**` via middleware in `src/proxy.ts`; keyless mode works locally (env.example shows optional keys). Use `ClerkProvider` + `useUser`/`useOrganization`; routes like profile/billing rely on organization context.
- **Navigation RBAC**: Nav items live in `src/config/nav-config.ts` with `access` fields (`requireOrg`, `permission`, `role`, optional `plan`/`feature`). Filtering is purely client-side UX through `useFilteredNavItems` (`src/hooks/use-nav.ts`) and consumed by `AppSidebar`/KBar; plan/feature checks must be enforced at page level.
- **Command Palette**: `components/kbar` reuses the same nav items; keep `nav-config` in sync when adding pages.
- **Dashboard Overview**: `src/app/dashboard/overview` uses parallel routes (`@sales`, `@pie_stats`, `@bar_stats`, `@area_stats`) composed in `layout.tsx`; segments simulate latency with `delay` from `constants/mock-api.ts` to demonstrate isolated loading states.
- **Products Table Pattern**: Product listing (`app/dashboard/product/page.tsx`) parses search params with `searchParamsCache.parse` (Nuqs server) and renders `ProductListingPage` (feature RSC). Data is fake (`constants/mock-api.ts`), columns defined in `features/products/components/product-tables`, and `ProductTable` uses `useDataTable` for manual pagination/sorting/filtering synced to URL query.
- **DataTable Utilities**: `useDataTable` (`src/hooks/use-data-table.ts`) is the source of truth for TanStack table state -> Nuqs query params (`page`, `perPage`, `sort`, filters). Helpers for operators live in `src/config/data-table.ts` and `src/lib/data-table.ts`; keep column `id` stable to avoid query breakage.
- **Forms**: Forms use React Hook Form + Zod with Shadcn form controls in `src/components/forms`. See `product-form.tsx` for file upload validation (size/type), selects, and textarea with char count; submit currently logs and redirects.
- **Kanban**: Kanban board (`features/kanban/components/kanban-board.tsx`) uses DnD Kit plus Zustand store persisted to localStorage (`useTaskStore` in `features/kanban/utils/store.ts`, key `task-store`, `skipHydration: true`). Columns/tasks are mutable; IDs generated via `uuid`.
- **Org/Billing**: Clerk Organizations power workspace/team/billing pages; billing uses `<Protect>` for plan/feature gating (Clerk beta). Keep nav items requiring org flagged with `access.requireOrg` to match UI expectations.
- **Sentry**: Enabled via `src/instrumentation.ts` (server/edge) and `src/instrumentation-client.ts` (client with Replay). Controlled by `NEXT_PUBLIC_SENTRY_DSN` and disabled when `NEXT_PUBLIC_SENTRY_DISABLED` is truthy; capture router transitions via exported hook.
- **Env Setup**: Copy `env.example.txt` to `.env.local`; Clerk URLs default to `/auth/sign-in` and `/auth/sign-up`. Sentry tokens optional unless you want stack traces/source maps.
- **Styling/Theme**: Global styles in `app/globals.css` and theme tokens in `app/theme.css`. Theme toggling via `components/layout/ThemeToggle/*` and `activeThemeValue` in cookies; keep CSS variables aligned when adding themes.
- **Layouts**: Use `PageContainer` (`components/layout/page-container.tsx`) for consistent headers, scroll handling, and CTA slots. Dashboard shell is `app/dashboard/layout.tsx` with sidebar/header wrappers.
- **State & Persistence**: Aside from Zustand (Kanban), most data is mock/fake and lives in `constants`. Do not assume backend; page-level protection still required for real data access.
- **Scripts & Tooling**: `bun run dev|build|start|lint`; `lint:fix` runs eslint then `bun format` (prettier). Husky hooks enabled via `prepare`. Tailwind v4 + Prettier plugin already configured.
- **Adding Routes**: Place new dashboard pages under `src/app/dashboard/*`; add metadata exports; hook into nav via `nav-config` and include command shortcuts if desired. Protect server actions/pages explicitly for auth/plan/feature as nav gating is UX only.
- **Search Params Workflow**: For RSCs needing query params, call `searchParamsCache.parse(searchParams)` at the page entry, then read via `searchParamsCache.get` deeper in the tree (see products). Keep serializer in `src/lib/searchparams.ts` in sync when adding params.
- **Assets & Icons**: Icons resolved from `Icons` map (`components/icons.tsx`); add new keys before referencing in nav/items.

If anything here feels off or incomplete, tell me which sections need more detail and Iâ€™ll refine it.